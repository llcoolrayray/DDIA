## 分区再平衡
随着时间的推移，数据库可能总会出现某些变化：
* 查询压力增加，因此需要更多的 CPU 来处理负载
* 数据规模增加，因此需要更多的磁盘和内存来存储数据
* 节点可能出现故障，因此需要其它的节点来接管失效的节点

所有这些变化都要求数据和请求可以从一个节点转移到另一个节点。这样一个迁移负载的过程称为再平衡。无论哪种分区方案都需要满足以下的条件：
* 平衡之后，负载，数据和请求等应该均匀的分布在各个分区中
* 再平衡的过程中，数据库应该可以正常提供读写服务
* 避免不必要的再平衡

## 动态再平衡的策略
#### 为什么不取模
之前介绍通过哈希值进行分区，将哈希值划分为不同的区间范围，然后将每个区间范围分配给一个分区。比如：区间 （a，b）分配给分区 0，区间 （b，c）分配给分区 1。

为什么不用`%`取模的方式指定分区呢？

例如：hash(key) = 123456，假定最初有 10 个节点，那么这个关键字应该在节点 6 中（123456 % 10 = 6）；当节点数增加到 11 时，它需要移动到
节点 3（123456 % 11 = 3）。由此可以看出采用取模的方式指定分区，当节点数量增加时，会出现很多不必要的再平衡。

#### 动态分区
当分区中的数据增长到一定程度时，它会自动分裂为 2 个分区。同理如果大量数据被删除，分区中数据的大小缩小到某个阈值，那么分区将会合并。

动态分区的一个优点是分区的数量可以自动的适配数据总量，如果只有少量的数据，那么少量的分区就足够了，这样系统开销很小。如果有大量的数据，每个分区的大小
则被限制在一个可配置的最大值。

#### 按节点比例分区
每一个节点中的分区数量一定。

## 自动与手动再平衡操作
**自动再平衡**
由系统自动决定何时将分区从一个节点迁移到另一个节点，不需要管理员的介入。

**手动再平衡**
分区到节点的映射由管理员显示配置